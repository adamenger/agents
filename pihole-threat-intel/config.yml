defaults:
  # Data source: "sqlite" (lightweight, local) or "opensearch" (SIEM pipeline)
  data_source: "sqlite"

  # SQLite (default) — reads PiHole's FTL database directly
  sqlite_pihole_db: "/etc/pihole/pihole-FTL.db"
  sqlite_eval_db: "/data/evaluations.db"

  # OpenSearch — used when data_source is "opensearch"
  opensearch_host: "localhost"
  opensearch_port: 9200
  opensearch_pihole_index_prefix: "pihole"
  opensearch_evaluations_index: "pihole-evaluations"

  # Ollama
  ollama_base_url: "http://localhost:11434"
  ollama_model: "qwen3:14b"

  # Agent behavior
  batch_size: 25
  lookback_hours: 24
  previous_evaluations_count: 20
  evaluation_ttl_days: 7

  # Email output — set email_enabled to true to send reports via SMTP
  # MailHog (SIEM profile) runs on localhost:1025 with a web UI at localhost:8025
  email_enabled: false
  smtp_host: "mailhog"
  smtp_port: 1025
  email_sender: "threat-intel@pihole.local"
  email_recipients: "analyst@pihole.local"

prompts:
  deepseek_system_prompt: |
    You are a DNS threat intelligence analyst. You evaluate domain names queried
    through a home network's Pi-hole DNS server and classify each as benign,
    suspicious, malicious, or unknown.

    Each domain comes with pre-gathered intelligence from public sources:
    - DNSBL results: Quad9, Cloudflare, Spamhaus DBL, SURBL blocklist checks
    - DNS records: A, MX, NS, TXT
    - RDAP: domain age and registrar
    - AlienVault OTX: community threat reports and malware associations

    Use this intelligence data to inform your classification. Key signals:
    - Blocked by Quad9/Cloudflare = strong malicious signal
    - Listed in Spamhaus/SURBL = confirmed threat with category
    - Domain age < 30 days = suspicious (newly registered)
    - OTX pulse count > 0 = community has reported this domain
    - DGA patterns: random-looking strings, unusual length
    - Resemblance to legitimate domains (typosquatting)

    Classify each domain with:
    - threat_level: benign, suspicious, malicious, or unknown
    - confidence: 0-100 (how certain you are)
    - reasoning: brief explanation referencing the intel data
    - indicators: list of specific threat indicators observed

    If a domain is blocked by multiple DNSBL sources, confidence should be high.
    If intel shows no signals and the domain looks normal, classify as benign with high confidence.
    Be conservative: only mark as malicious with clear evidence from the intel data.
    Keep your reasoning concise.

  claude_system_prompt: |
    You are an expert DNS threat intelligence analyst performing secondary review
    of domains flagged as potentially threatening by a primary analysis model.
    These domains had low confidence scores in initial assessment.

    Provide definitive classifications with detailed reasoning. You have access
    to broader threat intelligence context. Be thorough but precise.

    Classify each domain with:
    - threat_level: benign, suspicious, malicious, or unknown
    - confidence: 0-100
    - reasoning: detailed explanation
    - indicators: specific threat indicators

  batch_user_prompt: |
    /nothink
    {learning_context}

    Evaluate each of these DNS domains queried on a home network.
    For each domain, provide threat_level, confidence, reasoning, and indicators.
    You MUST evaluate ALL domains listed below. Do not skip any.

    Domains to evaluate:
    {domain_list}

  previous_evaluations_header: |
    Here are recent evaluations for reference — use these for consistency:

  no_previous_evaluations: |
    No previous evaluations available. This is the first run.

known_domains:
  suffixes:
    # Google
    - ".google.com"
    - ".googleapis.com"
    - ".googlevideo.com"
    - ".googleusercontent.com"
    - ".gstatic.com"
    - ".google-analytics.com"
    - ".googleadservices.com"
    - ".googlesyndication.com"
    - ".doubleclick.net"
    # Apple
    - ".apple.com"
    - ".icloud.com"
    - ".mzstatic.com"
    - ".apple-dns.net"
    # Microsoft
    - ".microsoft.com"
    - ".microsoftonline.com"
    - ".windows.com"
    - ".windows.net"
    - ".office.com"
    - ".office365.com"
    - ".live.com"
    - ".outlook.com"
    - ".bing.com"
    - ".msftconnecttest.com"
    # Amazon / AWS
    - ".amazon.com"
    - ".amazonaws.com"
    - ".amazontrust.com"
    - ".cloudfront.net"
    # Cloudflare
    - ".cloudflare.com"
    - ".cloudflare-dns.com"
    - ".one.one.one.one"
    # Meta
    - ".facebook.com"
    - ".fbcdn.net"
    - ".instagram.com"
    - ".whatsapp.net"
    # CDN / Infrastructure
    - ".akamai.net"
    - ".akamaized.net"
    - ".akamaitechnologies.com"
    - ".fastly.net"
    - ".edgekey.net"
    - ".edgesuite.net"
    # DNS / NTP
    - ".ntp.org"
    - ".in-addr.arpa"
    - ".ip6.arpa"
    # Common services
    - ".github.com"
    - ".githubusercontent.com"
    - ".docker.com"
    - ".docker.io"
    - ".debian.org"
    - ".ubuntu.com"
    - ".npmjs.org"
    - ".pypi.org"
    - ".spotify.com"
    - ".netflix.com"
    - ".roku.com"
    - ".plex.tv"
    - ".plex.direct"
    - ".slack.com"
    - ".zoom.us"
    - ".dropbox.com"
    # Home automation
    - ".home-assistant.io"
    - ".ecobee.com"
    - ".nest.com"
    # Local / internal
    - ".local"
    - ".lan"
    - ".internal"
    - ".localdomain"
    - ".home.arpa"

  exact:
    - "localhost"
    - "gateway"
    - "pi.hole"

output:
  summary_header: "=== PiHole Threat Intel Report ==="
  summary_footer: "=== End Report ==="
  alert_prefix: "[ALERT]"
  no_threats_message: "All clear — no threats detected."
  stats_template: |
    Domains queried (24h):  {total_domains_queried}
    After known-good filter: {domains_after_filtering}
    Already evaluated:       {domains_already_evaluated}
    Evaluated this run:      {domains_to_evaluate}
    Batches processed:       {batches_processed}

    Results:
      Benign:     {benign_count}
      Suspicious: {suspicious_count}
      Malicious:  {malicious_count}
      Unknown:    {unknown_count}
      Errors:     {errors}
