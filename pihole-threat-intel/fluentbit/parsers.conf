# Pi-hole v5 query log (dnsmasq format)
# Parses lines like:
#   Feb  6 14:23:01 dnsmasq[123]: query[A] example.com from 192.168.1.100
#   Feb  6 14:23:01 dnsmasq[123]: forwarded example.com to 1.1.1.1
[PARSER]
    Name          pihole
    Format        regex
    Regex         ^(?<time>[A-Za-z]{3} [ \d]{2} \d{2}:\d{2}:\d{2}) dnsmasq\[(?<pid>\d+)\]: (?<action>query|forwarded|reply|cached|config|gravity|blacklist|regex)\[(?<query_type>[A-Z0-9]+)\] (?<domain>\S+) (from|to|is) (?<client_or_target>\S+)$
    Time_Key      time
    Time_Format   %b %d %H:%M:%S

# Pi-hole FTL log
[PARSER]
    Name          pihole_ftl
    Format        regex
    Regex         ^\[(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+)\] \[(?<level>[A-Z]+)\] (?<message>.*)$
    Time_Key      time
    Time_Format   %Y-%m-%d %H:%M:%S.%L
